model Category {
  id     Int     @id @default(autoincrement())
  name   String  @unique
  active Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  products Product[]
  coupons  CategoryCoupon[]
}

model Product {
  id             String  @id @default(uuid())
  categoryId     Int
  name           String
  retailPrice    Int?
  wholesalePrice Int?
  description    String  @db.Text
  imageUrl       String?

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  // Relations
  category   Category           @relation(fields: [categoryId], references: [id])
  stock      ProductStock?
  promotions ProductPromotion[]
  orderItems OrderItem[]
  coupons    ProductCoupon[]
}

model ProductStock {
  productId String @id
  quantity  Int    @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  version   Int      @default(0)

  // Relations
  product Product @relation(fields: [productId], references: [id])
}

model ProductPromotion {
  id           String @id @default(uuid())
  productId    String
  paidQuantity Int
  freeQuantity Int

  // 프로모션 적용 기간
  startAt DateTime  @default(now()) // 시작일
  endAt   DateTime? // 종료일 (null이면 무기한)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  product Product @relation(fields: [productId], references: [id])

  @@unique([productId, paidQuantity])
}
